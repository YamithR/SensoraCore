Descripción de la Obra
Software: SENSORA_BRIGHTNESS

El software SENSORA_BRIGHTNESS es un módulo educativo que forma parte del ecosistema SensoraCore, diseñado para el monitoreo en tiempo real de niveles de luminosidad mediante sensores de fotorresistencia (LDR - Light Dependent Resistor). A través de esta plataforma, el ESP32 ejecuta firmware en MicroPython que lee valores analógicos de una fotorresistencia conectada en configuración de divisor de voltaje y los transmite mediante socket TCP a través de WiFi. La interacción con el sistema se realiza mediante una aplicación de escritorio desarrollada en Python con PySide6 que actúa como cliente TCP para recibir y procesar los datos de luminosidad.

• DISEÑO
El sistema se basa en una arquitectura cliente-servidor donde el ESP32 actúa como servidor TCP y la aplicación de escritorio como cliente. El ESP32 DevKit V1 ejecuta un firmware desarrollado en MicroPython que lee continuamente un pin analógico donde se conecta una fotorresistencia (LDR) en configuración de divisor de voltaje con una resistencia fija. El microcontrolador convierte las lecturas ADC (0-4095) a valores de voltaje y porcentajes de luminosidad, transmitiendo estos datos a través de sockets TCP por WiFi. La aplicación cliente, desarrollada en Python con PySide6, se conecta al ESP32, recibe los datos en tiempo real y los visualiza mediante múltiples widgets incluyendo displays LCD, barras de progreso y labels numéricos.

• IMPLEMENTACIÓN
El firmware del ESP32 está programado en MicroPython utilizando las librerías nativas machine, network y socket. El microcontrolador configura un pin GPIO como ADC con resolución de 12 bits y atenuación de 11dB para leer el rango completo de 0-3.3V del divisor de voltaje formado por la LDR y resistencia fija. El firmware establece un servidor TCP en el puerto 8080 y acepta conexiones entrantes de la aplicación cliente, enviando datos estructurados en formato SENSOR:LDR,ADC:<valor>,VOLT:<voltaje>. La aplicación de escritorio está desarrollada en Python 3.x con PySide6 para la interfaz gráfica, utilizando QObject con threading para comunicación asíncrona y widgets especializados como QLCDNumber y QProgressBar para visualización múltiple.

Funciones que tiene el software:
• Lectura Analógica de LDR: el ESP32 lee la fotorresistencia conectada en divisor de voltaje con resolución de 12 bits (0-4095).
• Conversión a Porcentaje: convierte valores ADC a porcentajes de luminosidad usando la fórmula porcentaje = (ADC * 100) / 4095.
• Servidor TCP Especializado: establece comunicación por socket TCP en puerto 8080 con comandos específicos BR_START y BR_STOP.
• Configuración de Intervalo: permite ajustar la frecuencia de muestreo mediante comando BR_START:<milisegundos>.
• Visualización Múltiple: la aplicación cliente muestra datos simultáneamente en display LCD, barra de progreso y valores numéricos.
• Monitoreo en Tiempo Real: actualización continua de todos los displays con datos de luminosidad y valores ADC crudos.
• Exportación de Datos: genera archivos Excel (.xlsx) con datos tabulados incluyendo tiempo, ADC, voltaje y porcentaje.
• Gestión de Estados: maneja inicio, pausa y limpieza de datos con preservación de conexión TCP.
• Threading Asíncrono: utiliza QObject con threading para evitar bloqueos de interfaz durante comunicación.

• VALIDACIÓN
La validación del software se llevó a cabo mediante pruebas de Funcionamiento, en las que se confirmó que el sistema integrado ESP32-Cliente es capaz de:
• Establecer conexión WiFi estable del ESP32 a la red local configurada en wifi_config.py.
• Crear servidor TCP en puerto 8080 y aceptar conexiones entrantes de la aplicación cliente.
• Leer valores analógicos de fotorresistencia con resolución ADC de 12 bits (0-4095) de forma continua.
• Convertir lecturas ADC a porcentajes de luminosidad con fórmula lineal y rango de 0% a 100%.
• Transmitir datos en tiempo real mediante sockets TCP sin pérdida significativa de paquetes.
• Procesar comandos BR_START para configuración de intervalo de muestreo y BR_STOP para finalización.

Asimismo, se verificó que la comunicación TCP entre el ESP32 y la aplicación cliente de escritorio mantiene estabilidad durante sesiones prolongadas de monitoreo, que la conversión ADC a porcentaje es lineal y precisa, y que la visualización múltiple (LCD, barra de progreso, valores numéricos) se actualiza sincrónicamente sin latencia perceptible.

• PLATAFORMA
Hardware:
• ESP32 DevKit V1: Microcontrolador de 32 bits con procesador Xtensa LX6 dual-core, equipado con WiFi 802.11b/g/n y Bluetooth integrados. Incluye múltiples pines GPIO con conversores ADC de 12 bits para lectura de sensores analógicos. El pin GPIO 34 se utiliza específicamente para la lectura de la fotorresistencia.
• Fotorresistencia (LDR): Sensor de luz variable que cambia su resistencia proporcionalmente a la intensidad lumínica. Rango típico de 1kΩ a 10MΩ con tiempo de respuesta menor a 100ms. Se conecta en configuración de divisor de voltaje con resistencia fija de 10kΩ entre 3.3V y GND.
• Resistencia Fija: Resistor de 10kΩ utilizado para formar divisor de voltaje con la LDR, proporcionando una señal analógica variable entre 0V y 3.3V proporcional a la luminosidad.
• Circuito de Acondicionamiento: Divisor de voltaje simple que convierte la variación resistiva de la LDR en variación de voltaje legible por el ADC del ESP32.

Software:
Para el firmware del ESP32 se emplea MicroPython con las librerías nativas machine para control de hardware, network para conectividad WiFi, socket para comunicación TCP y time para temporizadores. El desarrollo y la carga del firmware se realizan utilizando entornos como Visual Studio Code (con extensiones para MicroPython) y Thonny, que facilitan la edición, depuración y transferencia de scripts al ESP32. La aplicación cliente se desarrolla en Python 3.x utilizando PySide6 para la interfaz gráfica moderna con widgets especializados como QLCDNumber para displays numéricos grandes, QProgressBar para representación gráfica y openpyxl para exportación de reportes Excel.

• AMBIENTE
El sistema opera como una plataforma educativa distribuida para el aprendizaje de sensores ópticos y sistemas de adquisición de datos analógicos. El ESP32 DevKit V1 ejecuta firmware MicroPython que establece un servidor TCP en puerto 8080, lee continuamente la fotorresistencia conectada al GPIO 34 en configuración de divisor de voltaje con resolución ADC de 12 bits, convierte los valores (0-4095) a porcentajes de luminosidad usando transformación lineal (0% a 100%), configura intervalos de muestreo mediante comandos BR_START:<ms>, y transmite los datos estructurados por WiFi a clientes conectados. La aplicación de escritorio desarrollada en Python actúa como cliente TCP, conectándose al ESP32 mediante su dirección IP local, recibiendo datos de forma asíncrona usando QObject con threading para evitar bloqueos de interfaz, procesando los datos mediante conversiones ADC a porcentaje, y presentando visualizaciones múltiples simultáneas con display LCD para porcentajes, barra de progreso visual, y valores numéricos para análisis técnico. El sistema incluye funcionalidades avanzadas como configuración dinámica de intervalos de muestreo, exportación automática de datos a Excel con metadatos de sesión, limpieza de datos con preservación de conexión, y gestión robusta de estados de comunicación, proporcionando una experiencia educativa completa que abarca desde conceptos básicos de sensores fotorresistivos hasta técnicas avanzadas de acondicionamiento de señales y visualización de datos en sistemas embebidos distribuidos.
